# ============================================================================
# CONFIGURACIÓN DEL SERVIDOR 2 - ARQUITECTURA P2P
# Este archivo debe llamarse: application-server2.properties
# ============================================================================

# ----------------------------------------------------------------------------
# CONFIGURACIÓN GENERAL DEL SERVIDOR
# ----------------------------------------------------------------------------
server.name=ChatServer-P2P-Server2
server.version=1.0.0
server.environment=development

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE RED
# ----------------------------------------------------------------------------
# Puerto principal del servidor TCP (DIFERENTE al servidor 1)
server.port=22101

# IP del servidor (0.0.0.0 para escuchar en todas las interfaces)
server.host=0.0.0.0

# Número máximo de conexiones simultáneas
server.max.connections=100

# Timeout de conexión en milisegundos
server.connection.timeout=30000

# ----------------------------------------------------------------------------
# CONFIGURACIÓN P2P (PEER-TO-PEER)
# ----------------------------------------------------------------------------

# Habilitar/deshabilitar funcionalidad P2P
p2p.enabled=true

# Puerto para comunicación P2P (DIFERENTE al servidor 1)
p2p.puerto=22101

# IP pública del peer (dejar vacío para auto-detectar)
# p2p.ip=

# Nombre descriptivo del servidor (opcional)
p2p.nombre.servidor=Servidor-Secundario

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE HEARTBEAT
# ----------------------------------------------------------------------------

# Intervalo de envío de heartbeats en milisegundos (30 segundos)
p2p.heartbeat.interval=30000

# Timeout de heartbeat - AUMENTADO a 5 minutos
p2p.heartbeat.timeout=300000

# Habilitar heartbeat automático
p2p.heartbeat.enabled=true

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE DESCUBRIMIENTO DE PEERS
# ----------------------------------------------------------------------------

# Habilitar descubrimiento automático de peers
p2p.discovery.enabled=true

# Intervalo de descubrimiento en milisegundos (5 minutos)
p2p.discovery.interval=300000

# Lista de peers conocidos - CONECTAR AL SERVIDOR 1
# Cambiar 172.29.128.1 por la IP real del servidor 1 si es diferente
p2p.peers.bootstrap=172.29.128.1:22100

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE CLIENTE P2P
# ----------------------------------------------------------------------------

# Timeout de conexión para cliente P2P en milisegundos (10 segundos)
p2p.client.timeout=10000

# Número máximo de threads para pool de conexiones P2P
p2p.client.pool.threads=10

# Reintentos de conexión en caso de fallo
p2p.client.retry.attempts=3

# Delay entre reintentos en milisegundos
p2p.client.retry.delay=1000

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE BASE DE DATOS
# ----------------------------------------------------------------------------

# Configuración de JPA/Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# Configuración de H2 Database - BASE DE DATOS DIFERENTE
spring.datasource.url=jdbc:h2:file:./data/chatdb2
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# Habilitar consola H2 (solo para desarrollo)
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE LOGGING
# ----------------------------------------------------------------------------

# Nivel de logging general
logging.level.root=INFO

# Nivel de logging para paquetes específicos
logging.level.com.arquitectura=DEBUG
logging.level.com.arquitectura.logicaPeers=DEBUG
logging.level.com.arquitectura.controlador=INFO
logging.level.org.springframework=WARN
logging.level.org.hibernate=WARN

# Archivo de logs - ARCHIVO DIFERENTE
logging.file.name=logs/server2.log
logging.file.max-size=10MB
logging.file.max-history=30

# Patrón de logging
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE ARCHIVOS
# ----------------------------------------------------------------------------

# Directorio base para almacenamiento de archivos - DIRECTORIO DIFERENTE
file.storage.base.path=./storage2

# Tamaño máximo de archivo en bytes (50 MB)
file.upload.max.size=52428800

# Tamaño de chunk para transferencia de archivos (1 MB)
file.chunk.size=1048576

# Tipos de archivo permitidos (separados por coma)
file.allowed.types=jpg,jpeg,png,gif,pdf,doc,docx,txt,mp3,wav,ogg

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE SEGURIDAD
# ----------------------------------------------------------------------------

# Habilitar autenticación
security.authentication.enabled=true

# Tiempo de expiración de sesión en minutos
security.session.timeout=60

# Número máximo de intentos de login fallidos
security.login.max.attempts=5

# Tiempo de bloqueo después de intentos fallidos (minutos)
security.login.lockout.duration=15

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE PERFORMANCE
# ----------------------------------------------------------------------------

# Tamaño del pool de threads para procesamiento asíncrono
async.executor.pool.size=10

# Tamaño máximo de cola para tareas asíncronas
async.executor.queue.capacity=100

# Habilitar caché
cache.enabled=true

# Tiempo de expiración de caché en segundos
cache.expiration=300

# ----------------------------------------------------------------------------
# CONFIGURACIÓN DE DESARROLLO/PRODUCCIÓN
# ----------------------------------------------------------------------------

# Perfil activo (development, production, test)
spring.profiles.active=development

# Habilitar modo debug
debug=false

# Habilitar actuator endpoints (solo desarrollo)
management.endpoints.web.exposure.include=health,info,metrics
